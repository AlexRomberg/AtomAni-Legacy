<!DOCTYPE html>
<!--
Copyright (c) 2021 Alexander Romberg
-->

<head>
  <title>AtomAni</title>

  <!-- stylesheets -->
  <link rel="stylesheet" href="/css/general.css">
  <link rel="stylesheet" href="/css/uac.css">

  <%- include('favicon'); %>

  <script src="/res/lib/jquery.min.js"></script>
  <script src="/js/uac.js" defer></script>
</head>

<body>
  <%- include('header',{ origin: `script.back` , title: "Benutzeraccounts" }) %>
  <main>
    <% if (messages.error) { %>
    <div id="errorMessage"><%= messages.error %></div>
    <% } %>
    <div class="content">
      <% users.forEach(user=>{ %>
      <div class="cardframe shadow">
        <div class="usercard shadow">
          <div class="infoarea">
            <div class="avatar">
              <img src="<%- user.UserImage ? user.UserImage : '/res/img/logo-small-light.svg' %>" alt="avatar">
            </div>
            <h2 class="name"><%- user.UserName %></h2>
            <h3>ID:</h3>
            <h3 class="userId"><%- user.UserIdentification %></h3>
          </div>
          <div class="permissionsarea">
            <p>Ist Admin:</p>
            <p>Kann bearbeiten:</p>
            <img src="<%- user.UserIsAdmin > 0? '/res/img/checkmark.svg" alt="Ja':'/res/img/cross.svg" alt="Nein' %>">
            <img src="<%- user.UserCanEdit > 0? '/res/img/checkmark.svg" alt="Ja':'/res/img/cross.svg" alt="Nein' %>">
          </div>
        </div>
        <div userid="<%- user.UserId %>" class="controls">
          <button class="deletebtn selectable">Löschen</button>
          <button class="editbtn selectable">Bearbeiten</button>
        </div>
      </div>
      <% }); %>
      <div class="usercard selectable-no-border" id="newcard">
        <div class="newcard">
          <img src="/res/img/menuIcons/add.svg" alt="Missing Folder Icon">
        </div>
        <div class="newcardtext">
          <h3>Hinzufügen</h3>
        </div>
      </div>
      <div class="userEditOverlay" style="display: none;">
        <div class="userEditDialog">
          <form action="/api/new/user" class="full-width-form" id="userEditForm" method="post">
            <div class="formbody">
              <h2 id="formTitle">Benutzer Hinzufügen</h2>
              <label for="UserId">Benutzer-ID:</label>
              <input class="selectable" autocomplete="username" type="text" name="UserId" id="UserId" pattern="[A-Za-z0-9_\-\.]*" required>
              <label for="UserName">Name:</label>
              <input class="selectable" autocomplete="name" type="text" name="UserName" id="UserName" pattern="[A-Za-z0-9\u00C0-\u00FC][A-Za-z0-9\u00C0-\u00FC_\- ]*" required>
              <label for="UserPW">Passwort:</label>
              <input class="selectable" autocomplete="new-password" type="password" name="UserPW" id="UserPW" required>
              <div class="inputRow">
                <label for="UserCanEdit">Kann bearbeiten:</label>
                <input class="selectable" type="checkbox" name="UserCanEdit" id="UserCanEdit">
              </div>
              <div class="inputRow">
                <label for="UserIsAdmin">Ist Admin:</label>
                <input class="selectable" type="checkbox" name="UserIsAdmin" id="UserIsAdmin">
              </div>
            </div>
            <div class="buttongroup">
              <input id="resetBtn" class="selectable" type="reset" value="Abbrechen">
              <input id="submitBtn" class="selectable" type="submit" value="Speichern">
            </div>
          </form>
        </div>
      </div>
    </div>
  </main>
  <%- include('footer.ejs', { Version }) %>
</body>